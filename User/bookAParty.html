<!DOCTYPE html>
<html lang="en">

    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <link href="./asset/css/bookAParty.css" rel="stylesheet">
        <link href="./asset/css/header.css" rel="stylesheet">
        <link href="./asset/css/footer.css" rel="stylesheet">
        <!-- Font Awesome -->
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css"
            integrity="sha512-z3gLpd7yknf1YoNbCzqRKc4qyor8gaKU1qmn+CShxbuBusANI9QpRohGBreCFkKxLhei6S9CQXFEbbKuqLg0DA=="
            crossorigin="anonymous" referrerpolicy="no-referrer" />
        <title>Book A Party</title>
    </head>

    <body>
        <!-- Header -->
        <div id="headerPlaceholder"></div>
        <script src="./header/header.js"></script>

        <div class="wrapper_book">
            <section class="content">
                <div class="btn-box">
                    <button id="btn-left" onclick="openTCT()">TỔ CHỨC TIỆC</button>
                    <button id="btn-right" onclick="openDHL()">ĐƠN HÀNG LỚN & ĐẶT TIỆC TẬN NƠI</button>
                </div>
                <div class="content-all" id="content-left">
                    <div style="padding-top: 30px;">
                        <center>
                            <b>
                                <p class="text-1" style="color: red; font-size: 18px;">BUỔI TIỆC KHÓ QUÊN CÙNG NHỮNG MÓN
                                    NGON TỪ ...</p>
                            </b>
                        </center>
                        <center>
                            <p class="text-2" style="color: rgb(0, 0, 0); font-size: 17px;">Chúng tôi sẵn sàng phục vụ
                                mọi bữa tiệc của bạn.</p>
                        </center>
                    </div>
                    <div style="padding-top: 50px;">
                        <center>
                            <img src="https://kfcvn-static.cognizantorderserv.com/images/email/party1vn.png" alt=""
                                style="width: 150px;">
                            <img src="https://kfcvn-static.cognizantorderserv.com/images/email/party1vn.png" alt=""
                                style="width: 150px;">
                            <img src="https://kfcvn-static.cognizantorderserv.com/images/email/party1vn.png" alt=""
                                style="width: 150px;">
                            <img src="https://kfcvn-static.cognizantorderserv.com/images/email/party1vn.png" alt=""
                                style="width: 150px;">
                            <img src="https://kfcvn-static.cognizantorderserv.com/images/email/party1vn.png" alt=""
                                style="width: 150px;">
                        </center>
                    </div>
                    <div style="padding-top: 30px;">
                        <center>
                            <button class="btn-datngay" id="datngay">ĐẶT NGAY</button>
                        </center>
                    </div>
                </div>
                <div class="content-all" id="content-right">
                    <div style="padding-top: 30px;">
                        <center>
                            <b>
                                <p class="text-1" style="color: red; font-size: 18px;">BUỔI TIỆC KHÓ QUÊN CÙNG NHỮNG MÓN
                                    NGON TỪ ...</p>
                            </b>
                        </center>
                        <center>
                            <p class="text-2" style="color: rgb(0, 0, 0); font-size: 17px;">Chúng tôi sẵn sàng phục vụ
                                mọi bữa tiệc của bạn.</p>
                        </center>
                    </div>
                    <div style="padding-top: 50px;">
                        <center>
                            <img src="https://kfcvn-static.cognizantorderserv.com/images/email/party1vn.png" alt=""
                                style="width: 150px;">
                            <img src="https://kfcvn-static.cognizantorderserv.com/images/email/party1vn.png" alt=""
                                style="width: 150px;">
                            <img src="https://kfcvn-static.cognizantorderserv.com/images/email/party1vn.png" alt=""
                                style="width: 150px;">
                        </center>
                    </div>
                    <div style="padding-top: 30px;">
                        <center>
                            <button class="btn-datngay" id="datngay1">ĐẶT NGAY</button>
                        </center>
                    </div>
                </div>
            </section>

            <section class="menu">
                <h2>Thực đơn tiệc</h2>
                <ul id="menuList" class="menu_list">
                    <!-- Các món ăn sẽ được thêm vào đây bằng JavaScript -->
                </ul>
            </section>


            <section class="book_party">
                <h2>Đặt tiệc</h2>
                <form id="bookingForm">
                    <!-- Hidden field to store customer ID -->
                    <input type="hidden" name="customerId" id="customerId">

                    <div>
                        <div>
                            <img src="https://kfcvn-static.cognizantorderserv.com/images/email/birthdaybanner.jpg"
                                alt="" style="width: 100%;">
                        </div>
                        <div style="display: flex; width: 100%;padding-left: 30%; padding-right: 30%;">

                            <div>
                                <div class="form-group">
                                    <b>
                                        <h3 style="color: red; border-bottom: 1px solid #000">Thông tin buổi tiệc</h3>
                                    </b>
                                </div>
                                <div class="form-group">
                                    <label for="date_order">Ngày</label>
                                    <input type="date" name="date_order" id="date_order" required>
                                </div>
                                <div class="form-group">
                                    <label for="time_order">Giờ</label>
                                    <input type="time" name="time_order" id="time_order" required>
                                </div>
                                <div class="form-group">
                                    <label for="quantity">Số lượng</label>
                                    <select name="quantity" id="quantity" style="width: 100%;">
                                        <option value="10">1-10</option>
                                        <option value="20">10-20</option>
                                        <option value="30">20+</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="address">Địa điểm</label>
                                    <input type="text" name="address" id="address" required>
                                </div>
                                <div class="form-group">
                                    <label for="content">Nội dung</label>
                                    <textarea name="content" id="content" rows="5"></textarea>
                                </div>
                            </div>
                        </div>

                        <div style="padding-top: 30px; padding-left: 45%; padding-right: 45%;">
                            <button class="btn-datngay" type="submit">ĐẶT TIỆC NGAY</button>
                        </div>
                    </div>
                </form>
            </section>
        </div>


        <!-- Footer -->
        <div class="wrapper_footer">
            <a href="#"><img class="logo" alt="logo" src="./asset/img/logo1.jpg" /></a>
            <div class="wrapper_footer-item">
                <span>Our Food</span>
                <a class="footer_item" href="menu.html?id=category1">Category 1</a>
                <a class="footer_item" href="menu.html?id=category2">Category 2</a>
                <!-- Add more categories as needed -->
            </div>
            <div class="wrapper_footer-item">
                <span>Contact</span>
                <a class="footer_item" href="#">Order Tracker</a>
                <a class="footer_item" href="#">Find a KFC</a>
                <a class="footer_item" href="#">Contact Us</a>
            </div>
            <div class="wrapper_footer-item">
                <span>Policy</span>
                <a class="footer_item" href="#">Operation Policy</a>
                <a class="footer_item" href="#">Terms And Conditions</a>
            </div>
            <div class="wrapper_footer-item">
                <a class="footer_item" href="#"><i class='bx bxl-facebook'></i></a>
                <a class="footer_item" href="#"><i class='bx bxl-twitter'></i></a>
                <a class="footer_item" href="#"><i class='bx bxl-tiktok'></i></a>
                <a class="footer_item" href="#"><i class='bx bxl-instagram'></i></a>
            </div>
        </div>
        <!-- Copyright -->
        <div class="copyright">
            <p>&#169;Copyright © 2023 KFC Vietnam</p>
        </div>

        <!-- JavaScript to manage localStorage and set customerId field -->
        <script>
            // Function to initialize the customer ID field
            function initializeCustomerId() {
                const customerId = localStorage.getItem('id_customer');
                if (customerId) {
                    document.getElementById('customerId').value = customerId;
                }
            }

            // Function to handle form submission
            async function handleFormSubmission(event) {
                event.preventDefault(); // Ngăn không gửi biểu mẫu theo cách mặc định

                const form = document.getElementById('bookingForm');
                const formData = new FormData(form);

                // Chuyển đổi FormData sang JSON
                const data = {
                    date_order: formData.get('date_order'),
                    time_order: formData.get('time_order'),
                    quantity: formData.get('quantity'),
                    address: formData.get('address'),
                    content: formData.get('content'),
                    customerId: formData.get('customerId')
                };


                try {
                    const response = await fetch('http://localhost:8080/api/v1/auth/bookparty/add?customerId=' + encodeURIComponent(data.customerId), {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({
                            date_order: data.date_order,
                            time_order: data.time_order,
                            quantity: data.quantity,
                            address: data.address,
                            content: data.content
                        })
                    });

                    if (response.ok) {
                        // Hiển thị thông báo thành công
                        document.getElementById('successMessage').innerText = 'Đặt hàng thành công!';
                        document.getElementById('successMessage').style.display = 'block';
                        document.getElementById('errorMessage').style.display = 'none';
                        form.reset(); // Xóa biểu mẫu nếu cần
                    } else {
                        // Hiển thị thông báo lỗi
                        const errorText = await response.text();
                        document.getElementById('errorMessage').innerText = 'Có lỗi xảy ra: ' + errorText;
                        document.getElementById('errorMessage').style.display = 'block';
                        document.getElementById('successMessage').style.display = 'none';
                    }
                } catch (error) {
                    // Xử lý lỗi mạng
                    document.getElementById('errorMessage').innerText = 'Có lỗi xảy ra: ' + error.message;
                    document.getElementById('errorMessage').style.display = 'block';
                    document.getElementById('successMessage').style.display = 'none';
                }
            }

            // Run the function when the page loads
            document.addEventListener('DOMContentLoaded', function () {
                initializeCustomerId();

                // Thêm sự kiện lắng nghe cho form
                const bookingForm = document.getElementById('bookingForm');
                bookingForm.addEventListener('submit', handleFormSubmission);
            });
        </script>

<script>
    document.addEventListener('DOMContentLoaded', async function () {
        const menuList = document.getElementById('menuList');

        try {
            // Gọi API để lấy dữ liệu thực đơn
            const response = await fetch('http://localhost:8080/api/v1/auth/foods');
            if (!response.ok) {
                throw new Error('Network response was not ok');
            }

            const foods = await response.json();

            // Hiển thị tối đa 6 món ăn
            const limitedFoods = foods.slice(0, 10);

            limitedFoods.forEach(food => {
                // Tạo phần tử danh sách cho từng món ăn
                const listItem = document.createElement('li');
                listItem.className = 'menu_list-item';

                listItem.innerHTML = `
                    <a href="#">
                        <img class="menu_list-img" src="../img/${food.imageFood}" alt="${food.nameFood}">
                        <h3>${food.nameFood}</h3>
                        <h3 class="price">${food.price} VND</h3>
                    </a>
                `;

                menuList.appendChild(listItem);
            });
        } catch (error) {
            console.error('Error fetching the menu:', error);
            // Hiển thị thông báo lỗi nếu cần
            menuList.innerHTML = '<p>Không thể tải dữ liệu thực đơn.</p>';
        }
    });
</script>



    </body>

</html>